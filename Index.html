<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SÃºper Pack Parejas 2026</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        :root { --bg: #0d1117; --accent: #58a6ff; --pink: #f85149; --card: #161b22; --green: #238636; }
        body { font-family: sans-serif; background: var(--bg); color: #c9d1d9; margin: 0; padding: 15px; text-align: center; }
        .card { background: var(--card); border: 1px solid #30363d; padding: 15px; border-radius: 12px; margin-bottom: 10px; }
        .hidden { display: none; }
        button { background: var(--green); color: white; border: none; padding: 10px; border-radius: 6px; font-weight: bold; margin: 5px; width: 90%; cursor: pointer; }
        input[type=text] { background: #010409; border: 1px solid #30363d; color: white; padding: 10px; border-radius: 6px; width: 80%; margin: 5px; }
        
        /* Dial Wavelength */
        .dial-box { position: relative; width: 200px; height: 100px; margin: 10px auto; border: 3px solid #30363d; border-radius: 100px 100px 0 0; background: #000; overflow: hidden; }
        #pointer { position: absolute; bottom: 0; left: 50%; width: 3px; height: 100%; background: var(--pink); transform-origin: bottom; transform: rotate(0deg); transition: transform 0.2s; z-index: 5; }
        #target { position: absolute; bottom: 0; left: 50%; width: 40px; height: 100%; background: rgba(88, 166, 255, 0.4); transform-origin: bottom; display: none; }

        /* Colores */
        .color-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; margin: 10px 0; }
        .color-box { height: 40px; border-radius: 4px; border: 1px solid white; cursor: pointer; }

        /* Chat */
        #chat { height: 100px; overflow-y: auto; background: #010409; padding: 10px; font-size: 0.8em; text-align: left; border-radius: 6px; margin: 10px 0; }
        .nav-btn { background: #30363d; width: 45%; font-size: 0.8em; }
    </style>
</head>
<body>

    <div id="setup" class="card">
        <h2>ðŸ”— Conectar</h2>
        <p>Tu ID: <b id="my-id">...</b></p>
        <input type="text" id="join-id" placeholder="ID de tu pareja">
        <button onclick="connect(document.getElementById('join-id').value)">Conectar</button>
    </div>

    <div id="game-container" class="hidden">
        <div style="display: flex; flex-wrap: wrap; justify-content: center;">
            <button class="nav-btn" onclick="showGame('w-game')">Dial</button>
            <button class="nav-btn" onclick="showGame('c-game')">CafÃ©/TÃ©</button>
            <button class="nav-btn" onclick="showGame('clr-game')">Colores</button>
            <button class="nav-btn" onclick="showGame('cat-game')">CategorÃ­as</button>
        </div>

        <div id="w-game" class="game-section">
            <div class="card">
                <h3>ðŸŽ¡ Dial</h3>
                <div class="dial-box"><div id="target"></div><div id="pointer"></div></div>
                <input type="range" style="width:80%" min="-85" max="85" value="0" oninput="moveDial(this.value)">
                <button onclick="newTarget()">Nuevo Objetivo</button>
                <button style="background:var(--pink)" onclick="revealTarget()">Revelar</button>
            </div>
        </div>

        <div id="c-game" class="game-section hidden">
            <div class="card">
                <h3>â˜• CafÃ© o TÃ©</h3>
                <input type="text" id="secret-word" placeholder="Palabra secreta (ella)">
                <button onclick="sendSecret()">Fijar Palabra</button>
                <p id="secret-notif" style="font-size:0.8em"></p>
            </div>
        </div>

        <div id="clr-game" class="game-section hidden">
            <div class="card">
                <h3>ðŸŽ¨ Adivina el Color</h3>
                <p style="font-size:0.8em">El GuÃ­a elige uno, el otro adivina por pista.</p>
                <div id="color-grid" class="color-grid"></div>
                <p id="color-msg"></p>
            </div>
        </div>

        <div id="cat-game" class="game-section hidden">
            <div class="card">
                <h3>ðŸš« 10 CategorÃ­as</h3>
                <p style="font-size:0.8em">Si decÃ­s lo mismo, Â¡PERDÃ‰IS!</p>
                <h4 id="current-cat" style="color:var(--accent)">Pulsa para empezar</h4>
                <button onclick="nextCat()">Siguiente CategorÃ­a</button>
            </div>
        </div>

        <div class="card">
            <div id="chat"></div>
            <input type="text" id="chat-in" placeholder="Mensaje / Pista / CategorÃ­a">
            <button onclick="sendMsg()">Enviar</button>
        </div>
    </div>

<script>
    const peer = new Peer();
    let conn;
    let cats = ["Fruta", "PaÃ­s", "Marca de coche", "Famoso/a", "Animal", "PelÃ­cula", "Color", "Deporte", "Comida", "Objeto"];
    let catIdx = 0;

    peer.on('open', id => { document.getElementById('my-id').innerText = id; });
    peer.on('connection', c => { conn = c; setupConn(); });

    function connect(id) { conn = peer.connect(id); setupConn(); }

    function setupConn() {
        document.getElementById('setup').classList.add('hidden');
        document.getElementById('game-container').classList.remove('hidden');
        genColors();
        
        conn.on('data', data => {
            if(data.type === 'dial') document.getElementById('pointer').style.transform = `translateX(-50%) rotate(${data.val}deg)`;
            if(data.type === 'chat') log("Pareja", data.msg);
            if(data.type === 'reveal') { document.getElementById('target').style.display = 'block'; document.getElementById('target').style.transform = `translateX(-50%) rotate(${data.val}deg)`; }
            if(data.type === 'cat') document.getElementById('current-cat').innerText = data.val;
            if(data.type === 'secret') document.getElementById('secret-notif').innerText = "Â¡Palabra pensada! Pregunta por el chat.";
        });
    }

    function showGame(id) {
        document.querySelectorAll('.game-section').forEach(s => s.classList.add('hidden'));
        document.getElementById(id).classList.remove('hidden');
    }

    // LÃ³gica Dial
    function moveDial(v) { document.getElementById('pointer').style.transform = `translateX(-50%) rotate(${v}deg)`; conn.send({type:'dial', val:v}); }
    let tAngle = 0;
    function newTarget() { tAngle = Math.floor(Math.random()*160)-80; document.getElementById('target').style.display='block'; document.getElementById('target').style.transform = `translateX(-50%) rotate(${tAngle}deg)`; }
    function revealTarget() { conn.send({type:'reveal', val:tAngle}); }

    // LÃ³gica Colores
    function genColors() {
        const grid = document.getElementById('color-grid');
        for(let i=0; i<15; i++) {
            let c = `hsl(${Math.random()*360}, 70%, 50%)`;
            let b = document.createElement('div');
            b.className = 'color-box'; b.style.backgroundColor = c;
            b.onclick = () => { log("SISTEMA", "Has marcado este color."); conn.send({type:'chat', msg: "He elegido un color de la lista..."}); };
            grid.appendChild(b);
        }
    }

    // LÃ³gica CategorÃ­as
    function nextCat() {
        let c = cats[catIdx % cats.length];
        document.getElementById('current-cat').innerText = c;
        conn.send({type:'cat', val:c});
        catIdx++;
    }

    // Chat y Secretos
    function sendSecret() { conn.send({type:'secret'}); document.getElementById('secret-notif').innerText = "Palabra enviada."; }
    function sendMsg() { let i = document.getElementById('chat-in'); log("TÃº", i.value); conn.send({type:'chat', msg:i.value}); i.value=""; }
    function log(u, m) { const d = document.getElementById('chat'); d.innerHTML += `<div><b>${u}:</b> ${m}</div>`; d.scrollTop = d.scrollHeight; }
</script>
</body>
</html>

